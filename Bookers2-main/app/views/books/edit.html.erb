<div class ="container">
  <div class="row">
    <div class="mx-auto col-5 px-0">
      <h1>Editing Book</h1>
      <% if @book.errors.any? %>
      <h3 class="text-danger"><%= pluralize(@book.errors.count, "error") %> prohibited this obj from being saved:</h3>
      <ul>
        <% @book.errors.full_messages.each do |message| %>
          <li class="text-danger"><%= message %></li>
        <% end %>
      </ul>
      <% end %>

      <!--<%= form_with model: @book, url: "/books/#{@book.id}", local:true do |f| %>-->
      <!--<div class="form-group">-->
      <!--  <%= f.label :title, 'Title' %>-->
      <!--  <%= f.text_field :title, class:"form-control" %>-->
      <!--</div>-->
      <!--<div class="form-group">-->
      <!--  <%= f.label :body, 'Opinion' %>-->
      <!--  <%= f.text_area :body, class:"form-control" %>-->
      <!--</div>-->
      <!--<div class="form-group" id="tag-app">-->
      <!--  <%= f.label :tag_name, 'Tag' %>-->
      <!--  <%= f.text_field :tag_name, value: @tag_list, class:"form-control" %>-->
      <!--</div>-->

      <form id="tag-app" action="/books/<%= @book.id %>" method="post">
        <input type="hidden" name="_method" value="patch">
        <input type="hidden" name="authenticity_token" value="avCsfA3uKfKVEyJfbVBrXJ0g1/YkJCx8tNndldbFLwRSGR9jnZ8ROrOZ/x1dxHa8/MQTtTde6aNIxA9mdPQckQ==">
        <div>
          <label for="title">Title</label>
          <input type="text" id="title" name="[book]title" value="<%= @book.title %>">
        </div>
        <div>
          <label for="body">Opinion</label>
          <input type="text" id="body" name="[book]body" value="<%= @book.body %>">
        </div>
        <div>
          <label for="tag_name">Tag</label>

          <input v-model="newTag" class="form-control" id="tag_name" type="text" name="book[tag_name]">
          <!--<input v-model="newTag">-->
          <p>{{newTag}}</p>
        </div>
        <div class="button">
          <button type="submit">Send</button>
        </div>
      </form>


    <!--  <div id="tag-app">-->
    <!--  <ul class="list-unstyled d-flex flex-wrap col-4 mx-auto border text-break px-0">-->
    <!--    <li v-for="(tag, index) in tags">{{tag}}-->
    <!--      <button type="button"v-on:click="delTag(tag)">×</button>-->
    <!--    </li>-->
    <!--    <li v-on:keydown.enter="setTag">-->
    <!--      <input class="border-0" type="text" style="outline: 0;" placeholder="新規タグを追加" name="Tag" v-model="newTag">-->
    <!--    </li>-->
    <!--  </ul>-->
    <!--</div>-->

    <script>
      new Vue ({
        el: '#tag-app',
        data () {
            return {
                tags: [] ,
                newTag: "<%= @tag_list %>",
            }
        },
        methods: {
          setTag: function (event) {
            if (event.keyCode !== 13) return
            var tag = this.newTag;
            this.tags.push(tag);
            this.newTag = '';
          },
          delTag: function(tag) {
            this.tags.splice(this.tags.indexOf(tag), 1);
          },
        }
      })
    </script>




      <div class="form-group" id="star-evaluation-<%= @book.id %>"></div>
      <script>
        $('#star-evaluation-<%= @book.id %>').raty({
          size     : 36,
          starOff:  '<%= asset_path('star-off.png') %>',
          starOn : '<%= asset_path('star-on.png') %>',
          starHalf: '<%= asset_path('star-half.png') %>',
          half: true,
          readOnly: true,
          score: <%= @book.evaluation %>,
        });
      </script>

      <!--<div class="form-group">-->
      <!--  <%= f.submit "Update Book", class:"btn btn-success" %>-->
      <!--</div>-->

        <%= link_to "Show", book_path(@book) %>
        |
        <%= link_to "Back", books_path %>
      <% end %>
    </div>
  </div>
</div>